# Zmeny a kroky (2026-01-05)

Tento zaznam shrnuje dnesni upravy a aktualni stav projektu MyCoder-v2.0.

## Hlavni cile
- Spousteni MyCoder pres prikaz mycoder.
- Lokalni MCP server jako fallback mimo domaci orchestrator.
- Volba providera klavesou Tab (prompt_toolkit).
- Vylepseni diffusing vystupu pro Mercury a cesky system prompt.
- Potlaceni hluku z Claude OAuth health checku.

## Implementovane zmeny

### CLI a spousteni
- Pridany entrypoint mycoder = mycoder.cli_interactive:main v pyproject.toml.
- CLI vyuziva ConfigManager pro nacitani/ukladani konfigurace a zobrazi tabulku provideru.
- Tab/Shift+Tab pro prepinani provideru (prompt_toolkit).
- Pri ulozenem API klici se znovu nevyzaduje zadani.

### Lokalni MCP server (fallback)
- Pridan src/local_mcp_server.py s jednoduchym MCP API.
- Endpointy: /health, /services, /mcp.
- Nastroje: soubory (cteni/zapis/list/search), terminal exec, git status/diff/log, memory.
- src/mycoder/mcp_connector.py startuje lokalni MCP, kdyz orchestrator neni dostupny.
- Stavy MCP se promitaji do health checku a server se korektne vypina.

### Mercury a diffusing
- Implementovan streaming parser pro Mercury (SSE data framy).
- Rezim diffusing prepinam na stream=True.
- Cesky system prompt: Odpovidej cesky. Nepouzivej slovenstinu ani jine jazyky.
- Cisteni diffusing vystupu: filtrace slov, deduplikace, minimalni pomer cistych slov,
  vlozeni podmetu model, normalizace (diffusion->difuze, realtime->v realnem case).
- Pokud je vysledek porad sum, aktivuje se fallback veta:
  Model difuze v realnem case umoznuje generovat vice tokenu najednou, coz zrychluje
  vystup a snizuje naklady.

### Claude OAuth hluk
- Claude OAuth health check je deaktivovany, pokud provider neni explicitne zapnuty.
- Default pro claude_oauth.enabled je false.

## Jak spustit
1) mycoder
2) Vyber providera (Tab/Shift+Tab, Enter).
3) Volitelne prikazy:
   - /realtime zapne realtime
   - /diffon zapne diffusing

## Zname limity
- Diffusing vystup muze byt stale nestabilni; aktivuje se fallback veta.
- Claude/Gemini bez API klice hlasi warningy v logu.

## Zmenene soubory
- src/local_mcp_server.py
- src/mycoder/mcp_connector.py
- src/mycoder/cli_interactive.py
- src/mycoder/api_providers.py
- src/mycoder/enhanced_mycoder_v2.py
- src/mycoder/config_manager.py
- pyproject.toml
- docs/cs/2026-01-05-prubeh.md
